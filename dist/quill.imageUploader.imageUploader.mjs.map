{"version":3,"file":"quill.imageUploader.imageUploader.mjs","sources":["../src/quill.imageUploader.js"],"sourcesContent":["class ImageUploader {\n  constructor(quill, options) {\n    this.quill = quill;\n    this.options = options;\n    this.range = null;\n\n    if (typeof this.options.upload !== \"function\")\n      console.warn(\n        \"[Missing config] upload function that returns a promise is required\"\n      );\n\n    var toolbar = this.quill.getModule(\"toolbar\");\n    toolbar.addHandler(\"image\", this.selectLocalImage.bind(this));\n  }\n\n  selectLocalImage() {\n    this.range = this.quill.getSelection();\n    this.fileHolder = document.createElement(\"input\");\n    this.fileHolder.setAttribute(\"type\", \"file\");\n    this.fileHolder.setAttribute(\"accept\", \"image/*\");\n    this.fileHolder.setAttribute(\"style\", \"visibility:hidden\");\n\n    this.fileHolder.onchange = this.fileChanged.bind(this);\n\n    document.body.appendChild(this.fileHolder);\n\n    this.fileHolder.click();\n\n    window.requestAnimationFrame(() => {\n      document.body.removeChild(this.fileHolder);\n    });\n  }\n\n  fileChanged() {\n    const file = this.fileHolder.files[0];\n\n    const fileReader = new FileReader();\n\n    if (file) {\n      fileReader.readAsDataURL(file);\n    }\n\n    this.options.upload(file).then(\n      imageUrl => {\n        this.insertToEditor(imageUrl);\n      },\n      error => {\n        console.warn(error.message);\n      }\n    );\n  }\n\n  insertBase64Image(url) {\n    const range = this.range;\n    this.quill.insertEmbed(range.index, \"image\", `${url}`);\n  }\n\n  insertToEditor(url) {\n    const range = this.range;\n    // Insert the server saved image\n    this.quill.insertEmbed(range.index, \"image\", `${url}`);\n\n    range.index++;\n    this.quill.setSelection(range, \"api\");\n  }\n}\n\nexport default ImageUploader;\n"],"names":["ImageUploader","constructor","quill","options","range","this","upload","console","warn","getModule","addHandler","selectLocalImage","bind","getSelection","fileHolder","document","createElement","setAttribute","onchange","fileChanged","body","appendChild","click","window","requestAnimationFrame","removeChild","file","files","fileReader","FileReader","readAsDataURL","then","imageUrl","insertToEditor","error","message","insertBase64Image","url","insertEmbed","index","setSelection"],"mappings":"AAAA,IAAMA,EACJC,SAAYC,EAAOC,QACZD,MAAQA,OACRC,QAAUA,OACVC,MAAQ,KAEsB,mBAAxBC,KAAKF,QAAQG,QACtBC,QAAQC,KACN,uEAGUH,KAAKH,MAAMO,UAAU,WAC3BC,WAAW,QAASL,KAAKM,iBAAiBC,KAAKP,QAGzDM,YAAAA,4CACOP,MAAQC,KAAKH,MAAMW,oBACnBC,WAAaC,SAASC,cAAc,cACpCF,WAAWG,aAAa,OAAQ,aAChCH,WAAWG,aAAa,SAAU,gBAClCH,WAAWG,aAAa,QAAS,0BAEjCH,WAAWI,SAAWb,KAAKc,YAAYP,KAAKP,eAExCe,KAAKC,YAAYhB,KAAKS,iBAE1BA,WAAWQ,QAEhBC,OAAOC,0CACIJ,KAAKK,YAAYpB,EAAKS,eAInCK,YAAAA,kCACQO,EAAOrB,KAAKS,WAAWa,MAAM,GAE7BC,EAAa,IAAIC,WAEnBH,GACFE,EAAWE,cAAcJ,QAGtBvB,QAAQG,OAAOoB,GAAMK,cACxBC,KACOC,eAAeD,aAEtBE,WACU1B,KAAK0B,EAAMC,YAKzBC,YAAAA,2BAAkBC,QAEXnC,MAAMoC,YADGjC,KAAKD,MACUmC,MAAO,WAAYF,IAGlDJ,YAAAA,wBAAeI,OACPjC,EAAQC,KAAKD,WAEdF,MAAMoC,YAAYlC,EAAMmC,MAAO,WAAYF,GAEhDjC,EAAMmC,aACDrC,MAAMsC,aAAapC,EAAO"}